<?xml version="1.0" encoding="ISO-8859-1"?>
<!DOCTYPE topic PUBLIC "-//OASIS//DTD DITA Topic//EN" "http://docs.oasis-open.org/dita/v1.1/OS/dtd/topic.dtd">
<topic id="tpc_vulnerability-summary-$reportContext.id" xmlns:ditaarch="http://dita.oasis-open.org/architecture/2005/">
    <title>$reportContext.combinedTitle("Vulnerabilities", true)</title>
#set($threshold=$report.getVulnerabilityScoreThreshold())
#set($vulnerabilities=$inventory.getApplicableVulnerabilityMetaData($threshold))
    <body>
#if($vulnerabilities.isEmpty())
        <p>
            No vulnerabilities have been identified.
        </p>
#else
        <p>
            The following vulnerabilities have been analyzed and categorized.
        </p>
        <p>
            In general, only vulnerabilities with Score<sub>max</sub><fn>The tables show both the CVSSv2 Score
            (Score<sub>v2</sub>) and the CVSSv3 Base Score (Score<sub>v3</sub>). Score<sub>max</sub> is the maximum
            score of Score<sub>v2</sub> and Score<sub>v3</sub>.</fn> higher or equal a threshold of $threshold are
            considered relevant and are detailed as potential or not applicable vulnerabilities. Nevertheless,
            independent of the score vulnerabilities can be raised to potential vulnerabilities or lowered to
            insignificant vulnerabilities in the given software context.
        </p>

        <section>
            <title>Potential Vulnerabilities</title>
            <body>
#if($vulnerabilities.isEmpty())
        <p>
            No potential vulnerabilities have been identified.
        </p>
#else
        <p>
        <table id="potential_vulnerabilities">
            <title>Potential Vulnerabilities$reportContext.inContextOf()</title>
            <tgroup cols="5">
                <colspec colname="COLSPEC0" colnum="1" colwidth="36*" />
                <colspec colname="COLSPEC1" colnum="2" colwidth="8*" />
                <colspec colname="COLSPEC2" colnum="3" colwidth="8*" />
                <colspec colname="COLSPEC3" colnum="4" colwidth="8*" />
                <colspec colname="COLSPEC4" colnum="5" colwidth="40*" />

                <thead>
                    <row>
                        <entry colname="COLSPEC0" valign="top">Name</entry>
                        <entry colname="COLSPEC1" valign="top">Score<sub>v2</sub></entry>
                        <entry colname="COLSPEC2" valign="top">Score<sub>v3</sub></entry>
                        <entry colname="COLSPEC3" valign="top">Score<sub>max</sub></entry>
                        <entry colname="COLSPEC4" valign="top">Alerts / Advisories / Notices</entry>
                    </row>
                </thead>

                <tbody>
#foreach($vulnerability in $vulnerabilities)
                    <row>
                        <entry><lines>#if($vulnerability.get("Product URIs"))<i>$report.xmlEscapeString($vulnerability.get("Product URIs"))</i>
#end<codeph>$report.xmlEscapeString($vulnerability.get("Name"))</codeph>
</lines></entry>
                        <entry>$report.xmlEscapeString($vulnerability.get("CVSS Score (v2)"))</entry>
                        <entry>$report.xmlEscapeString($vulnerability.get("CVSS Base Score (v3)"))</entry>
                        <entry outputclass="bgcolor(#F0FFFF)">$report.xmlEscapeString($vulnerability.get("Maximum Score"))</entry>
                        <entry>$vulnerabilityAdapter.hyperlinkedAdvisories($vulnerabilityAdapter.getAdvisories($vulnerability))</entry>
                    </row>
#end
                </tbody>
            </tgroup>
        </table>
        </p>
#end
        </body>
        </section>

        <section>
            <title>Not Applicable Vulnerabilities</title>
            <body>
#set($vulnerabilities=$inventory.getNotApplicableVulnerabilityMetaData($threshold))
#if($vulnerabilities.isEmpty())
        <p>
            No vulnerabilities have been identified, which are regarded inapplicable in this context.
        </p>
#else
        <p>
            Not applicable vulnerabilities include a rationale of the vulnerability assessment.
        </p>
        <p>
        <table id="not_applicable_vulnerabilities">
            <title>Not Applicable Vulnerabilities$reportContext.inContextOf()</title>
            <tgroup cols="5">
                <colspec colname="COLSPEC0" colnum="1" colwidth="20*" />
                <colspec colname="COLSPEC1" colnum="2" colwidth="10*" />
                <colspec colname="COLSPEC2" colnum="3" colwidth="10*" />
                <colspec colname="COLSPEC3" colnum="4" colwidth="10*" />
                <colspec colname="COLSPEC4" colnum="5" colwidth="50*" />

                <thead>
                    <row>
                        <entry colname="COLSPEC0" valign="top">Name</entry>
                        <entry colname="COLSPEC1" valign="top">Score<sub>v2</sub></entry>
                        <entry colname="COLSPEC2" valign="top">Score<sub>v3</sub></entry>
                        <entry colname="COLSPEC3" valign="top">Score<sub>max</sub></entry>
                        <entry colname="COLSPEC4" valign="top">Rationale</entry>
                    </row>
                </thead>

                <tbody>
#foreach($vulnerability in $vulnerabilities)
                    <row>
                        <entry><lines><i>$report.xmlEscapeString($vulnerability.get("Product URIs"))</i>
<codeph>$report.xmlEscapeString($vulnerability.get("Name"))</codeph>
</lines></entry>
                        <entry>$report.xmlEscapeString($vulnerability.get("CVSS Score (v2)"))</entry>
                        <entry>$report.xmlEscapeString($vulnerability.get("CVSS Base Score (v3)"))</entry>
                        <entry>$report.xmlEscapeString($vulnerability.get("Maximum Score"))</entry>
                        <entry>$vulnerability.get("Rationale", "")</entry>
                    </row>
#end
                </tbody>
            </tgroup>
        </table>
        </p>
#end
        </body>
        </section>

        <section>
            <title>Insignificant Vulnerabilities</title>
            <body>
#set($vulnerabilities=$inventory.getInsignificantVulnerabilities($threshold))
#if($vulnerabilities.isEmpty())
        <p>
            No insignificant vulnerabilities have been identified.
        </p>
#else
        <p>
            The following vulnerabilities are not considered of relevance in the given context.
        </p>
        <p>
        <table id="insignificant_vulnerabilities">
            <title>Insignificant Vulnerabilities$reportContext.inContextOf()</title>
            <tgroup cols="5">
                <colspec colname="COLSPEC0" colnum="1" colwidth="20*" />
                <colspec colname="COLSPEC1" colnum="2" colwidth="10*" />
                <colspec colname="COLSPEC2" colnum="3" colwidth="10*" />
                <colspec colname="COLSPEC3" colnum="4" colwidth="10*" />
                <colspec colname="COLSPEC4" colnum="5" colwidth="50*" />

                <thead>
                    <row>
                        <entry colname="COLSPEC0" valign="top">Name</entry>
                        <entry colname="COLSPEC1" valign="top">Score<sub>v2</sub></entry>
                        <entry colname="COLSPEC2" valign="top">Score<sub>v3</sub></entry>
                        <entry colname="COLSPEC3" valign="top">Score<sub>max</sub></entry>
                        <entry colname="COLSPEC4" valign="top">Remark</entry>
                    </row>
                </thead>

                <tbody>
#foreach($vulnerability in $vulnerabilities)
                    <row>
                        <entry><lines><i>$report.xmlEscapeString($vulnerability.get("Product URIs"))</i>
<codeph>$report.xmlEscapeString($vulnerability.get("Name"))</codeph>
</lines></entry>
                        <entry>$report.xmlEscapeString($vulnerability.get("CVSS Score (v2)"))</entry>
                        <entry>$report.xmlEscapeString($vulnerability.get("CVSS Base Score (v3)"))</entry>
                        <entry>$report.xmlEscapeString($vulnerability.get("Maximum Score"))</entry>
                        <entry>$vulnerability.deriveRemark()</entry>
                    </row>
#end
                </tbody>
            </tgroup>
        </table>
        </p>
#end
        </body>
        </section>
#end
    </body>
</topic>
