#parse("META-INF/templates/en/inventory-report-vulnerability/macros/inventory-report-cert.vm")
<?xml version="1.0" encoding="ISO-8859-1"?>
<!DOCTYPE topic PUBLIC "-//OASIS//DTD DITA Topic//EN" "http://docs.oasis-open.org/dita/v1.1/OS/dtd/topic.dtd">
<topic id="tpc_vulnerability-summary-$reportContext.id" xmlns:ditaarch="http://dita.oasis-open.org/architecture/2005/">
    <title>$reportContext.combinedTitle("Security Advisories", true)</title>
##
#set ($securityAdvisories = $vulnerabilityAdapter.getSecurityAdvisories())
##
## see AdvisoryMetaData attributes
#set ($securityAdvisoriesUnaffected = $vulnerabilityAdapter.filterSecurityAdvisoriesForReviewStatus($securityAdvisories, "unaffected"))
#set ($securityAdvisoriesUnreviewed = $vulnerabilityAdapter.filterSecurityAdvisoriesForReviewStatus($securityAdvisories, "unclassified"))
#set ($securityAdvisoriesNew = $vulnerabilityAdapter.filterSecurityAdvisoriesForReviewStatus($securityAdvisories, "new"))
#set ($securityAdvisoriesInReview = $vulnerabilityAdapter.filterSecurityAdvisoriesForReviewStatus($securityAdvisories, "in review"))
#set ($securityAdvisoriesReviewed = $vulnerabilityAdapter.filterSecurityAdvisoriesForReviewStatus($securityAdvisories, "reviewed"))
##
#set ($queryPeriod = $vulnerabilityAdapter.getAdvisorPeriodicQueryPeriod())
##
    <body>
##
#if ($securityAdvisories.isEmpty())
        <p>
            No security advisories have been identified for the query period#if($queryPeriod) ($queryPeriod)#end.
        </p>
##
#else ## !$securityAdvisories.isEmpty()
        <p>
            The following security advisories have been detected for the query period#if($queryPeriod) ($queryPeriod)#end.
        </p>
## new
        <section>
            <title>New Security Advisories</title>
            <body>
#if (!$securityAdvisoriesNew.isEmpty())
                <p>
                    The following security advisories are new in the given context and have not yet been considered
                    during vulnerability assessments.
                </p>
                <p>
#securityAdvisoryOverviewTable("new_cert", "New Security Advisories", $securityAdvisoriesNew)
                </p>
#else
                <p>
                    No security advisories are present in the query period that are considered new in this context and
                    have not yet been considered during vulnerability assessments.
                </p>
#end
            </body>
        </section>
## in review
        <section>
            <title>Security Advisories in Review</title>
            <body>
#if (!$securityAdvisoriesInReview.isEmpty())
                <p>
                    The following security advisories are new in the query period. The review of security advisories and
                    verification of related vulnerability assessments are in progress.
                </p>
                <p>
#securityAdvisoryOverviewTable("in_review_cert", "Security Advisories in Review", $securityAdvisoriesInReview)
                </p>
#else
                <p>
                    No security advisories are present in the query period that are currently under review.
                </p>
#end
            </body>
        </section>
## reviewed
        <section>
            <title>Reviewed Security Advisories</title>
            <body>
#if (!$securityAdvisoriesReviewed.isEmpty())
                <p>
                    The following security advisories are new in the query period. These advisories have already been
                    considered in the assessment of the related vulnerabilities.
                </p>
                <p>
#securityAdvisoryOverviewTable("reviewed_cert", "Reviewed Security Advisories", $securityAdvisoriesReviewed)
                </p>
#else
                <p>
                    No security advisories are present in the query period that have already been considered in the
                    assessment of the related vulnerabilities.
                </p>
#end
            </body>
        </section>
## unaffected
        <section>
            <title>Not relevant Security Advisories</title>
            <body>
#if (!$securityAdvisoriesUnaffected.isEmpty())
                <p>
                    The following security advisories are included in the query period.
                    The related vulnerabilities are not relevant in this context.
                    The advisories are listed to provide a comprehensible report.
                </p>
                <p>
#securityAdvisoryOverviewTable("unaffected_cert", "Not relevant Security Advisories", $securityAdvisoriesUnaffected)
                </p>
#else
                <p>
                    No security advisories are present in the query period that are considered irrelevant in this
                    context.
                </p>
#end
            </body>
        </section>
## unclassified
#if (!$report.isFilterAdvisorySummary())
#if (!$securityAdvisoriesUnreviewed.isEmpty())
        <section>
            <title>Security Advisories Summary</title>
            <body>
                <p>
                    The following security advisories are not present in the query period, but have been matched by
                    the affected components.
                    The advisories are listed to provide a comprehensible report.
                </p>
                <p>
#securityAdvisoryOverviewTable("unclassified_cert", "Security Advisories Summary", $securityAdvisoriesUnreviewed)
                </p>
            </body>
        </section>
#end
#end
#end
    </body>
</topic>
