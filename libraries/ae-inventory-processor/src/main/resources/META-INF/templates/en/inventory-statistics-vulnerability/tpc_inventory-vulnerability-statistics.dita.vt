#parse("META-INF/templates/en/labels-vulnerability-assessment/macros/labels.vm")
#parse("META-INF/templates/en/inventory-report-vulnerability/macros/inventory-report-vulnerabilities.vm")
#set($threshold=$report.getVulnerabilityScoreThreshold())
<?xml version="1.0" encoding="ISO-8859-1"?>
<!DOCTYPE topic PUBLIC "-//OASIS//DTD DITA Topic//EN" "http://docs.oasis-open.org/dita/v1.1/OS/dtd/topic.dtd">
<topic id="tpc_vulnerability-summary-$reportContext.id">
    <title>$reportContext.combinedTitle("Vulnerability Statistics", true)</title>

    <body>
        <p id="statistics-preface">
            The following table shows statistics for the identified vulnerabilities. The vulnerabilities are included
            in the statistics with their original unmodified severity.
        </p>
        <p id="statistics-table">
#statisticsOverviewTableUnmodified("vulnerabilities_statistics_table_unmodified_all", "Vulnerability Statistics$reportContext.inContextOf()", "", $threshold)
        </p>


## iterate over all advisories that shall have their own overview table
#foreach($advisory in $report.getGenerateOverviewTablesForAdvisories())
        <p id="statistics-preface-$advisory">
            The following table shows statistics for the identified vulnerabilities with advisory information from
            $advisory. The vulnerabilities are included in the statistics with their original unmodified severity.
        </p>
        <p id="statistics-table-$advisory">
#statisticsOverviewTableUnmodified("vulnerabilities_statistics_table_unmodified_$advisory.toLowerCase()", "Vulnerability Statistics with $advisory Advisories$reportContext.inContextOf()", "$advisory", $threshold)
        </p>
#end


        <p id="statistics-preface-modified">
            The following table shows statistics for the identified vulnerabilities. The vulnerabilities are included
            in the statistics with their modified severity if available or their unmodified severity otherwise.
        </p>
        <p id="statistics-table-modified">
#statisticsOverviewTableModified("vulnerabilities_statistics_table_modified_all", "Effective Vulnerability Statistics$reportContext.inContextOf()", "", $threshold)
        </p>


## iterate over all advisories that shall have their own modified overview table
#foreach($advisory in $report.getGenerateOverviewTablesForAdvisories())
        <p id="statistics-preface-modified-$advisory">
            The following table shows statistics for the identified vulnerabilities with advisory information from
            $advisory. The vulnerabilities are included in the statistics with their modified severity if available or
            their unmodified severity otherwise.
        </p>
        <p id="statistics-table-modified-$advisory">
#statisticsOverviewTableModified("vulnerabilities_statistics_table_modified_$advisory.toLowerCase()", "Effective Vulnerability Statistics with $advisory Advisories$reportContext.inContextOf()", "$advisory", $threshold)
        </p>
#end
    </body>
</topic>
