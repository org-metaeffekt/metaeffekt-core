#parse("META-INF/templates/en/labels-vulnerability-assessment/macros/labels.vm")
#parse("META-INF/templates/en/inventory-report-vulnerability/macros/inventory-report-vulnerabilities.vm")
<?xml version="1.0" encoding="ISO-8859-1"?>
<!DOCTYPE topic PUBLIC "-//OASIS//DTD DITA Topic//EN" "http://docs.oasis-open.org/dita/v1.1/OS/dtd/topic.dtd">
<topic id="tpc_vulnerability-summary-$reportContext.id">
    <title>$reportContext.combinedTitle("Vulnerability Statistics", true)</title>
##
#set ($vulnerabilities = $vulnerabilityAdapter.getEffectiveVulnerabilitiesAll())
##
    <body>
        <p id="statistics-preface">
            The following table shows statistics for the identified vulnerabilities. The vulnerabilities are included
            in the statistics with their original unmodified severity.
        </p>
        <p id="statistics-table">
#statisticsOverviewTable("vulnerabilities_statistics_table_unmodified_all", "Vulnerability Statistics$reportContext.inContextOf()", $vulnerabilities, "", false)
        </p>


## iterate over all advisories that shall have their own overview table
#foreach($advisory in $report.getGenerateOverviewTablesForAdvisories())
    #set ($advisoryName = $advisory.getWellFormedName())
    #set ($advisoryIdentifier = $advisory.name())
##
        <p id="statistics-preface-$advisoryIdentifier">
            The following table shows statistics for the identified vulnerabilities with advisory information from
            $advisoryName. The vulnerabilities are included in the statistics with their original unmodified severity.
        </p>
        <p id="statistics-table-$advisoryIdentifier">
#statisticsOverviewTable("vulnerabilities_statistics_table_unmodified_$report.xmlEscapeStringAttribute($advisoryIdentifier.toLowerCase())", "Vulnerability Statistics with $report.xmlEscapeString($advisoryName) Advisories$reportContext.inContextOf()", $vulnerabilities, $advisory, false)
        </p>
#end


        <p id="statistics-preface-modified">
            The following table shows statistics for the identified vulnerabilities. The vulnerabilities are included
            in the statistics with their modified severity if available or their unmodified severity otherwise.
        </p>
        <p id="statistics-table-modified">
#statisticsOverviewTable("vulnerabilities_statistics_table_modified_all", "Context Vulnerability Statistics$reportContext.inContextOf()", $vulnerabilities, "", true)
        </p>


## iterate over all advisories that shall have their own modified overview table
#foreach($advisory in $report.getGenerateOverviewTablesForAdvisories())
    #set ($advisoryName = $advisory.getWellFormedName())
    #set ($advisoryIdentifier = $advisory.name())
##
        <p id="statistics-preface-modified-$advisoryIdentifier">
            The following table shows statistics for the identified vulnerabilities with advisory information from
            $advisoryName. The vulnerabilities are included in the statistics with their modified severity if available or
            their unmodified severity otherwise.
        </p>
        <p id="statistics-table-modified-$advisoryIdentifier">
#statisticsOverviewTable("vulnerabilities_statistics_table_modified_$report.xmlEscapeStringAttribute($advisoryIdentifier.toLowerCase())", "Context Vulnerability Statistics with $report.xmlEscapeString($advisoryName) Advisories$reportContext.inContextOf()", $vulnerabilities, $advisory, true)
        </p>
#end
    </body>
</topic>
