#macro (vulnerabilityOverview $id $title $vulnerabilities)
<table id="$id">
    <title>$title</title>
    <tgroup cols="6">
        <colspec colname="COLSPEC0" colnum="1" colwidth="24*" />
        <colspec colname="COLSPEC1" colnum="2" colwidth="8*" />
        <colspec colname="COLSPEC2" colnum="3" colwidth="8*" />
        <colspec colname="COLSPEC3" colnum="4" colwidth="8*" />
        <colspec colname="COLSPEC4" colnum="5" colwidth="40*" />
        <colspec colname="COLSPEC5" colnum="6" colwidth="12*" />
        <thead>
            <row>
                <entry colname="COLSPEC0" valign="top">Name</entry>
                <entry colname="COLSPEC1" valign="top">Score<sub>v2</sub></entry>
                <entry colname="COLSPEC2" valign="top">Score<sub>v3</sub></entry>
                <entry colname="COLSPEC3" valign="top">Score<sub>max</sub></entry>
                <entry colname="COLSPEC4" valign="top">Alerts / Advisories / Notices</entry>
                <entry colname="COLSPEC5" valign="top">Severity</entry>
            </row>
        </thead>

        <tbody>
#foreach($vulnerability in $vulnerabilities)
            <row>
                <entry>
                    <lines><line>#if ($vulnerability.get("Product URIs"))<i>$report.xmlEscapeString($vulnerability.get("Product URIs"))</i>#end</line>
                        <line>#if ($vulnerabilityAdapter.hasDetails($vulnerability, $threshold))<xref href="tpc_inventory-vulnerability-details.dita#$vulnerability.get("Name")" type="topic"><codeph>$report.xmlEscapeString($vulnerability.get("Name"))</codeph></xref>#else$vulnerability.get("Name")#end</line></lines>
                </entry>
                <entry>$report.xmlEscapeString($vulnerability.get("CVSS Score (v2)"))</entry>
                <entry>$report.xmlEscapeString($vulnerability.get("CVSS Base Score (v3)"))</entry>
                <entry>$report.xmlEscapeString($vulnerability.get("Maximum Score"))</entry>
                <entry>$vulnerabilityAdapter.hyperlinkedAdvisories($vulnerabilityAdapter.getAdvisories($vulnerability))</entry>
                <entry>
                    #set($labelColor=$vulnerabilityAdapter.getLabelColor($vulnerability))
                    <svg-container><svg:svg xmlns:svg="http://www.w3.org/2000/svg" width="56px" height="20px">
                        <svg:rect x="0" y="0" rx="3" ry="3" width="56" height="20" style="fill:$labelColor.getBackground()" />
                        <svg:text text-anchor="middle" alignment-baseline="central" fill="$labelColor.getForeground()">
                            <svg:tspan x="28" y="14" font-weight="bold">$vulnerability.get("CVSS Severity")</svg:tspan>
                        </svg:text>
                    </svg:svg></svg-container>
                </entry>
            </row>
#end
        </tbody>
    </tgroup>
</table>
#end