#parse("META-INF/templates/en/inventory-report-vulnerability/macros/inventory-report-vulnerabilities.vm")
<?xml version="1.0" encoding="ISO-8859-1"?>
<!DOCTYPE topic PUBLIC "-//OASIS//DTD DITA Topic//EN" "http://docs.oasis-open.org/dita/v1.1/OS/dtd/topic.dtd">
<topic id="tpc_vulnerability-summary-$reportContext.id" xmlns:ditaarch="http://dita.oasis-open.org/architecture/2005/">
    <title>$reportContext.combinedTitle("Vulnerability Overview", true)</title>
#set($threshold=$report.getVulnerabilityScoreThreshold())
#set($vulnerabilities=$vulnerabilityAdapter.getVulnerabilityMetaDataForDetailReport($threshold))
    <body>
#if($vulnerabilities.isEmpty())
        <p>
            No vulnerabilities have been identified.
        </p>
#else
        <p>
            The following vulnerabilities have been analyzed and categorized.
        </p>

        <section>
            <title>Potential Vulnerabilities</title>
            <body>
#set($vulnerabilities=$inventory.getApplicableVulnerabilityMetaData($threshold, true))
#if($vulnerabilities.isEmpty())
        <p>
            No potential vulnerabilities have been identified.
        </p>
#else
        <p>
#vulnerabilityOverview("potential_vulnerabilities", "Potential Vulnerabilities$reportContext.inContextOf()", $vulnerabilities)
        </p>
#end
        </body>
        </section>

        <section>
            <title>Not Applicable Vulnerabilities</title>
            <body>
#set($vulnerabilities=$inventory.getNotApplicableVulnerabilityMetaData($threshold, true))
#if($vulnerabilities.isEmpty())
        <p>
            No vulnerabilities have been identified, which are regarded inapplicable in this context.
        </p>
#else
        <p>
#vulnerabilityOverview("not_applicable_vulnerabilities", "Not Applicable Vulnerabilities$reportContext.inContextOf()", $vulnerabilities)
        </p>
#end
        </body>
        </section>

        <section>
            <title>Insignificant Vulnerabilities</title>
            <body>
#set($vulnerabilities=$inventory.getInsignificantVulnerabilities($threshold, true))
#if($vulnerabilities.isEmpty())
        <p>
            No insignificant vulnerabilities have been identified.
        </p>
#else
        <p>
            The following vulnerabilities are not considered of relevance in the given context.
        </p>
        <p>
#vulnerabilityOverview("insignificant_vulnerabilities", "Insignificant Vulnerabilities$reportContext.inContextOf()", $vulnerabilities)
        </p>
#end
        </body>
        </section>
#end
    </body>
</topic>
