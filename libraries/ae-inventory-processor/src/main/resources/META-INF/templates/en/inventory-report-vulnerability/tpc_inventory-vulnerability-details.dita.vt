<?xml version="1.0" encoding="ISO-8859-1"?>
<!DOCTYPE topic PUBLIC "-//OASIS//DTD DITA Topic//EN" "http://docs.oasis-open.org/dita/v1.1/OS/dtd/topic.dtd">
<topic id="tpc_vulnerability-summary-$reportContext.id" xmlns:ditaarch="http://dita.oasis-open.org/architecture/2005/">
    <title>$reportContext.combinedTitle("Vulnerability Details", true)</title>
#set($vulnerabilities=$vulnerabilityAdapter.getVulnerabilityMetaDataForDetailReport())
    <body>
#if($vulnerabilities.isEmpty())
        <p>
            No vulnerabilities have been identified.
        </p>
#else
        <p>
            Details are provided for vulnerabilities which are either applicable or which have
            third-party advisories.
        </p>
    </body>
#foreach($vulnerability in $vulnerabilities)
    <topic id="$vulnerability.get("Name")">
        <title>$vulnerability.get("Name")</title>
        <body>
            <section>
                <title>Summary</title>
                <body>
                    $report.xmlEscapeContentString($vulnerability.get("Description"))
                </body>
            </section>

            <section>
                <title>Severity</title>
                <body>
                    <p>CVSS Vector (v2): $report.xmlEscapeContentString($vulnerability.get("CVSS Vector (v2)"))</p>
                    <p>CVSS Vector (v3): $report.xmlEscapeContentString($vulnerability.get("CVSS Vector (v3)"))</p>
                </body>
            </section>

            <section>
                <title>Weakness</title>
                <body>
                    $report.xmlEscapeContentString($vulnerability.get("Weakness"))
                </body>
            </section>

            <section>
                <title>References</title>
                <body>
                    NVD: $report.xmlEscapeContentString($vulnerability.get("Url"))
                </body>
            </section>
        </body>
        <topic id="$vulnerability.get("Name")-assessment">
            <title>Assessment</title>
            <body>
                <section>
                    <title>Applicability</title>
                    <body>
                        <p>Status: $report.xmlEscapeContentString($vulnerability.get("Status"))</p>
                        <p>$report.xmlEscapeContentString($vulnerability.get("Rationale"))</p>
                    </body>
                </section>

                <section>
                    <title>Risk</title>
                    <body>
                        $report.xmlEscapeContentString($vulnerability.get("Risk"))
                    </body>
                </section>

                <section>
                    <title>Measures</title>
                    <body>
                        $report.xmlEscapeContentString($vulnerability.get("Measures"))
                    </body>
                </section>
            </body>
        </topic>
#foreach ($advisory in $vulnerabilityAdapter.getAdvisories($vulnerability))
        <topic id="$advisory.id">
            <title>Advisory $advisory.id ($advisory.source)</title>
            <body>
                <p>
                    $report.xmlEscapeContentString($advisory.url)
                </p>
                <section>
                    <title>Overview</title>
                    <body>
                        <p>$report.xmlEscapeContentString($advisory.overview)</p>
                    </body>
                </section>

                <section>
                    <title>Description</title>
                    <body>
                        <p>$report.xmlEscapeContentString($advisory.description)</p>
                    </body>
                </section>

                <section>
                    <title>Threat</title>
                    <body>
                        <p>$report.xmlEscapeContentString($advisory.threat)</p>
                    </body>
                </section>

                <section>
                    <title>Recommendations</title>
                    <body>
                        <p>$report.xmlEscapeContentString($advisory.recommendations)</p>
                    </body>
                </section>

                <section>
                    <title>Workarounds</title>
                    <body>
                        <p>$report.xmlEscapeContentString($advisory.workarounds)</p>
                    </body>
                </section>

                <section>
                    <title>Acknowledgements</title>
                    <body>
                        <p>$report.xmlEscapeContentString($advisory.acknowledgements)</p>
                    </body>
                </section>

            </body>
        </topic>
#end
    </topic>
#end
#end
</topic>
