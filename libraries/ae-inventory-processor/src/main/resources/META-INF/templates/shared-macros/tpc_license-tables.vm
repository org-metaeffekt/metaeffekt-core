#macro (insertLicenseTable $id $title $licenseList $handleSubstructure)
<table id="$id">
    <title>$title$reportContext.withTitle()</title>
    #if($configParams.enableOpenCodeStatus)
    <tgroup cols="5">
        <colspec colname="COLSPEC0" colnum="1" colwidth="50*"/>
        <colspec colname="COLSPEC1" colnum="2" colwidth="18*"/>
        <colspec colname="COLSPEC2" colnum="3" colwidth="13*"/>
        <colspec colname="COLSPEC3" colnum="4" colwidth="11*"/>
        <colspec colname="COLSPEC4" colnum="5" colwidth="8*"/>
        <thead>
        <row>
            <entry colname="COLSPEC0" valign="top">$utils.getText("inventory-report-bom.license-overview-title")</entry>
            <entry colname="COLSPEC1" valign="top">SPDX Id</entry>
            <entry colname="COLSPEC2" valign="top">OSI Status</entry>
            <entry colname="COLSPEC3" valign="top">Open CoDE Approval</entry>
            <entry colname="COLSPEC4" valign="top">$utils.getText("general.short.count")</entry>
        </row>
        </thead>
    #else
    <tgroup cols="4">
        <colspec colname="COLSPEC0" colnum="1" colwidth="53*" />
        <colspec colname="COLSPEC1" colnum="2" colwidth="25*" />
        <colspec colname="COLSPEC2" colnum="3" colwidth="10*" />
        <colspec colname="COLSPEC3" colnum="4" colwidth="12*" />
        <thead>
        <row>
            <entry colname="COLSPEC0" valign="top">$utils.getText("inventory-report-bom.short.licenses-in-effect")</entry>
            <entry colname="COLSPEC1" valign="top">SPDX Id</entry>
            <entry colname="COLSPEC2" valign="top">OSI Status</entry>
            <entry colname="COLSPEC3" valign="top">$utils.getText("general.short.count")</entry>
        </row>
        </thead>
    #end
    #set($osiStatusMap = $assetAdapter.getOsiStatusMap($configParams))
    #set($openCoDEStatusMap = {
        "approved" : "yes",
        "(approved)" : "(yes)",
        "not approved" : "no"
    })
    <tbody>
        #foreach($license in $licenseList)
            #if (!$license.contains(" + "))
                #set($licenseData=$inventory.findMatchingLicenseData($license))
            <row>
                #if ($handleSubstructure && $assetData.isLicenseSubstructureRequired($license))
                    <entry>
                        <xref href="#tpc_associated_license_details_$inventory.deriveLicenseId($license)" type="topic">
                            $report.xmlEscapeLicense($license)<xref href="#tpc_asset-license-summary-$reportContext.id/id-footnote" type="fn"/>
                        </xref>
                    </entry>
                    <entry>
                        #if ($licenseData && $utils.notEmpty($licenseData.get('SPDX Id')))
                            $report.xmlEscapeString($licenseData.get('SPDX Id'))
                        #else
                            &nbsp;
                        #end
                    </entry>
                    <entry>
                        #if ($licenseData)
                            #set($mappedStatus=$reportContext.map($licenseData.get("OSI Status"), $osiStatusMap))
                            #if ($mappedStatus)
                                $mappedStatus<xref href="#tpc_asset-license-summary-$reportContext.id/id-opencode-similar" type="fn"/>
                            #end
                        #else
                            &nbsp;
                        #end
                    </entry>
                    #if($configParams.enableOpenCodeStatus)
                        <entry>
                            #if ($licenseData)
                                #set($mappedStatus=$reportContext.map($licenseData.get("Open CoDE Status"), $openCoDEStatusMap))
                                #if ($mappedStatus)
                                    $mappedStatus<xref href="#tpc_asset-license-summary-$reportContext.id/id-footnote" type="fn"/>
                                #end
                            #else
                                &nbsp;
                            #end
                        </entry>
                    #end
                #else
                    <entry>
                        <xref href="#tpc_associated_license_details_$inventory.deriveLicenseId($license)" type="topic"> $report.xmlEscapeLicense($license)</xref>
                    </entry>
                    <entry>
                        #if ($licenseData && $utils.notEmpty($licenseData.get('SPDX Id')))
                            $report.xmlEscapeString($licenseData.get('SPDX Id'))
                        #else
                            &nbsp;
                        #end
                    </entry>
                    <entry>
                        #if ($licenseData)
                            $reportContext.map($licenseData.get("OSI Status"), $osiStatusMap,"&nbsp;")
                        #else
                            &nbsp;
                        #end
                    </entry>
                    #if($configParams.enableOpenCodeStatus)
                        <entry>
                            #if ($licenseData)
                                        $reportContext.map($licenseData.get("Open CoDE Status"), $openCoDEStatusMap, "&nbsp;")
                                    #end
                        </entry>
                    #end
                #end
                <entry>
                    <xref href="#tpc_associated_license_details_$inventory.deriveLicenseId($license)" type="topic">
                        <codeph>$assetData.countAssetsWithRepresentedAssociatedLicense($license, $handleSubstructure)</codeph>
                    </xref>
                </entry>
            </row>
            #end
        #end
    </tbody>
</tgroup>
</table>
#end