#parse("META-INF/templates/inventory-report-vulnerability/macros/inventory-report-cert.vm")
<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE topic PUBLIC "-//OASIS//DTD DITA Topic//EN" "http://docs.oasis-open.org/dita/v1.1/OS/dtd/topic.dtd">
<topic id="tpc_vulnerability-summary-$reportContext.id" xmlns:ditaarch="http://dita.oasis-open.org/architecture/2005/">
    <title>$reportContext.combinedTitle("Security Advisories", true)</title>
    ##
    #set ($securityAdvisories = $vulnerabilityAdapter.getSecurityAdvisories())

    ##
## see AdvisoryMetaData attributes
#set ($securityAdvisoriesUnaffected = $vulnerabilityAdapter.filterSecurityAdvisoriesForReviewStatus($securityAdvisories, "unaffected"))
#set ($securityAdvisoriesUnreviewed = $vulnerabilityAdapter.filterSecurityAdvisoriesForReviewStatus($securityAdvisories, "unclassified"))
#set ($securityAdvisoriesNew = $vulnerabilityAdapter.filterSecurityAdvisoriesForReviewStatus($securityAdvisories, "new"))
#set ($securityAdvisoriesInReview = $vulnerabilityAdapter.filterSecurityAdvisoriesForReviewStatus($securityAdvisories, "in review"))
#set ($securityAdvisoriesReviewed = $vulnerabilityAdapter.filterSecurityAdvisoriesForReviewStatus($securityAdvisories, "reviewed"))
##
#set ($queryPeriod = $vulnerabilityAdapter.getAdvisorPeriodicQueryPeriod())
##
    <body>
##
#if ($securityAdvisories.isEmpty())
        <p>$utils.getText("inventory-report-vulnerability.no-security-advisories")</p>
##
#else ## !$securityAdvisories.isEmpty()
        <p>$utils.getText("inventory-report-vulnerability.security-advisories")</p>
## new
        <section>
            <title>$utils.getText("inventory-report-vulnerability.short.new-security-advisories")</title>
            <body>
#if (!$securityAdvisoriesNew.isEmpty())
                <p>$utils.getText("inventory-report-vulnerability.new-security-advisories")</p>
                <p>
#securityAdvisoryOverviewTable("new_cert", "New Security Advisories", $securityAdvisoriesNew)
                </p>
#else
                <p>$utils.getText("inventory-report-vulnerability.no-new-security-advisories")</p>
#end
            </body>
        </section>
## in review
        <section>
            <title>$utils.getText("inventory-report-vulnerability.advisories-in-review")</title>
            <body>
#if (!$securityAdvisoriesInReview.isEmpty())
                <p>$utils.getText("inventory-report-vulnerability.security-advisories-in-review")</p>
                <p>
#securityAdvisoryOverviewTable("in_review_cert", "Security Advisories in Review", $securityAdvisoriesInReview)
                </p>
#else
                <p>$utils.getText("inventory-report-vulnerability.no-security-advisories-in-review")</p>
#end
            </body>
        </section>
## reviewed
        <section>
            <title>$utils.getText("inventory-report-vulnerability.advisories-in-review")</title>
            <body>
#if (!$securityAdvisoriesReviewed.isEmpty())
                <p>$utils.getText("inventory-report-vulnerability.security-advisories-reviewed")</p>
                <p>
#securityAdvisoryOverviewTable("reviewed_cert", "Reviewed Security Advisories", $securityAdvisoriesReviewed)
                </p>
#else
                <p>$utils.getText("inventory-report-vulnerability.no-security-advisories-reviewed")</p>
#end
            </body>
        </section>
## unaffected
        <section>
            <title>$utils.getText("inventory-report-vulnerability.not-relevant-security-advisories")</title>
            <body>
#if (!$securityAdvisoriesUnaffected.isEmpty())
                <p>$utils.getText("inventory-report-vulnerability.security-advisories-unaffected")</p>
                <p>
#securityAdvisoryOverviewTable("unaffected_cert", "Not relevant Security Advisories", $securityAdvisoriesUnaffected)
                </p>
#else
                <p>$utils.getText("inventory-report-vulnerability.no-security-advisories-unaffected")</p>
#end
            </body>
        </section>
## unclassified
#if (!$report.isFilterAdvisorySummary())
        <section>
            <title>$utils.getText("inventory-report-vulnerability.security-advisories-summary")</title>
            <body>
#if (!$securityAdvisoriesUnreviewed.isEmpty())
                <p>$utils.getText("inventory-report-vulnerability.security-advisories-unreviewed")</p>
                <p>
#securityAdvisoryOverviewTable("unclassified_cert", "Security Advisories Summary", $securityAdvisoriesUnreviewed)
                </p>
#else
                <p>$utils.getText("inventory-report-vulnerability.no-security-advisories-unreviewed")</p>
#end
            </body>
        </section>
#end
#end
    </body>
</topic>
