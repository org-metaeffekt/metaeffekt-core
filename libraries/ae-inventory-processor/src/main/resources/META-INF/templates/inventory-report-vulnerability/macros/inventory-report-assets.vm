## do not insert blank lines in between macros. as this document is loaded before the XML tag of the main document,
## this will result in the empty lines appearing at the head of the document, which is not allowed in XML.
##
##
##
#macro(componentsInAffectedAssetTable $templateRegistry $id $artifacts $assetName)
<table id="$id">
    <title>${assetName} $utils.getText("inventory-report-vulnerability.short.affected-components")</title>
    <tgroup cols="3">
        <colspec colname="COLSPEC0" colnum="1" colwidth="40*"/>
        <colspec colname="COLSPEC1" colnum="2" colwidth="46*"/>
        <colspec colname="COLSPEC2" colnum="3" colwidth="14*"/>

        <thead>
        <row>
            <entry colname="COLSPEC0" valign="top">$utils.getText("general.short.component")</entry>
            <entry colname="COLSPEC1" valign="top">$utils.getText("general.short.artifact-id")</entry>
            <entry colname="COLSPEC2" valign="top">Version</entry>
        </row>
        </thead>
        <tbody>
          #foreach($artifact in $artifacts)
            #if(!$vulnerabilityAdapter.getVulnerabilitiesForArtifact($artifact).isEmpty())
            <row>
                <entry>
                  #if($report.isInventoryVulnerabilityReportEnabled())
                      <xref href="$registry.resolve($templateRegistry, "component-$report.xmlEscapeStringAttribute($artifact.getComponent())")"
                            type="topic">$report.xmlEscapeString($artifact.getComponent())</xref>
                  #else
                    $report.xmlEscapeString($artifact.getComponent())
                  #end
                </entry>
                <entry>
                    <codeph>$report.xmlEscapeArtifactId($artifact.get("Id"))</codeph>
                </entry>
                <entry>
                    <codeph>$report.xmlEscapeGAV($artifact.get("Version"))</codeph>
                </entry>
            </row>
            #end
          #end
        </tbody>
    </tgroup>
</table>
#end